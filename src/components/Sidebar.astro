---
import { getCollection } from "astro:content";

interface Props {
  currentTitle: string;
}

const { currentTitle } = Astro.props;

const all = await getCollection("photos");
const others = all.filter((p) => p.data.title !== currentTitle);
const shuffled = others.sort(() => Math.random() - 0.5).slice(0, 5);
---

<aside>
  <p class="label">Other</p>
  <div class="list">
    {shuffled.map((photo) => {
      const id = photo.data.title.replace(":", "");
      const src = `/images/low/${id}.webp`;
      return (
        <a href={`/photos/${id}`} class="card">
          <div class="image-wrap">
            <img src={src} alt={photo.data.title} />
          </div>
          <p class="title">{photo.data.title}</p>
        </a>
      );
    })}
  </div>
</aside>

<style>
  aside {
    width: 400px;
    flex-shrink: 0;
    background: #000;
    border-left: 1px solid #222;
    padding: 1rem 0.75rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .label {
    font-family: "Cormorant Garamond", serif;
    font-weight: 300;
    font-size: 0.75rem;
    letter-spacing: 0.2em;
    color: #666;
    margin: 0 0 0.5rem;
  }

  .list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .card {
    text-decoration: none;
    color: inherit;
    background: #fff;
    padding: 5%;
    padding-bottom: 0;
    display: block;
  }

  .image-wrap {
    width: 100%;
    aspect-ratio: 1 / 1;
    overflow: hidden;
  }

  .image-wrap img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    display: block;
  }

  .card:hover .image-wrap img {
    opacity: 0.8;
  }

  .title {
    font-family: "Cormorant Garamond", serif;
    font-weight: 300;
    font-size: 1.2rem;
    letter-spacing: 0.1em;
    margin: 0;
    padding: 0.5rem 0.25rem;
    color: #000;
  }
</style>