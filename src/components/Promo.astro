---
interface Props {
  variant?: "offframe" | "new" | "about";
  size?:    "card" | "horizontal";
}

const { variant = "offframe", size = "card" } = Astro.props;

const content = {
  offframe: {
    titleMulti:  "枠を外し、\n写真の外側に\n広がる世界へ。",
    titleSingle: "枠を外し、写真の外側に広がる世界へ。",
    sub:         "OFFフレームモードを\n無料体験する",
    subSingle:   "OFFフレームモードを無料体験する",
    hTitle:      "OFF FRAME MODE",
    cta:         "詳しくは",
    href:        "/mypage",
  },
  new: {
    titleMulti:  "新しい\n素顔が\n届きました。",
    titleSingle: "新しい素顔が届きました。",
    sub:         "NEW\n新着フォト",
    subSingle:   "NEW　新着フォト",
    hTitle:      "NEW ARRIVAL",
    cta:         "新着を見る",
    href:        "/",
  },
  about: {
    titleMulti:  "存在しない\n日常の\n向こう側へ。",
    titleSingle: "存在しない日常の向こう側へ。",
    sub:         "OFF FRAME\n素の、その時間。",
    subSingle:   "OFF FRAME　素の、その時間。",
    hTitle:      "OFF FRAME",
    cta:         "About",
    href:        "/about",
  },
} as const;

const c = content[variant];
---

<a class={`promo promo--${size}${variant === "offframe" ? " promo--trigger" : ""}`} href={c.href} data-variant={variant}>
  <div class="promo-inner">
    <p class="promo-title promo-title--multi">{size === "horizontal" ? c.hTitle : c.titleMulti}</p>
    <p class="promo-title promo-title--single">{c.titleSingle}</p>
    <div class="promo-right">
      <p class="promo-sub promo-sub--multi">{c.sub}</p>
      <p class="promo-sub promo-sub--single">{c.subSingle}</p>
      <span class="promo-cta">{c.cta} →</span>
    </div>
  </div>
</a>

<style>
  /* ============ 共通 ============ */
  .promo {
    display: block;
    background: #fff;
    text-decoration: none;
    width: 100%;
    box-sizing: border-box;
    transition: transform 0.2s ease;
  }

  .promo:hover { transform: translateX(-2px) scale(1.01); }

  .promo-title {
    font-family: "Shippori Mincho", serif;
    font-weight: 400;
    letter-spacing: 0.2em;
    color: #000;
    margin: 0;
    white-space: pre-line;
    line-height: 2;
  }

  .promo-sub {
    font-family: "Cormorant Garamond", serif;
    font-weight: 300;
    letter-spacing: 0.2em;
    color: #000;
    margin: 0;
    white-space: pre-line;
  }

  .promo-cta {
    font-family: "Cormorant Garamond", serif;
    font-weight: 500;
    letter-spacing: 0.2em;
    color: #000;
    opacity: 0.55;
    border-bottom: 1px solid #ccc;
    padding-bottom: 0.1rem;
    white-space: nowrap;
    flex-shrink: 0;
    align-self: flex-start;
    display: inline-block;
  }

  /* デフォルト：single非表示 */
  .promo-title--single { display: none; }
  .promo-sub--single   { display: none; }

  /* ============ カード型（変更なし） ============ */
  .promo--card {
    container-type: inline-size;
    container-name: promo-c;
    padding: 10%;
  }

  .promo--card .promo-inner {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .promo--card .promo-right {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .promo--card .promo-title { font-size: 1.5rem; letter-spacing: 0.4rem; margin-right: -1.5rem;}
  .promo--card .promo-sub   { font-size: 1.05rem; letter-spacing: 0.25rem; line-height: 2rem;}
  .promo--card .promo-cta   { font-size: 1.2rem; margin-top: 2rem; }

  @container promo-c (min-width: 300px) {
    .promo--card .promo-title { font-size: 1.8rem; }
    .promo--card .promo-sub   { font-size: 1rem;}
    .promo--card .promo-cta   { font-size: 0.78rem; }
  }

  @container promo-c (max-width: 200px) {
    .promo--card { padding: 8%; }
    .promo--card .promo-title { font-size: 1.2rem; letter-spacing: 0.3rem;}
    .promo--card .promo-sub   { font-size: 0.95rem; letter-spacing: 0.15rem; line-height: 1.7rem;}
    .promo--card .promo-cta   { font-size: 1rem; margin-top: 1rem;}
  }

  @container promo-c (max-width: 150px) {
    .promo--card { padding: 8%; }
    .promo--card .promo-title { font-size: 1.05rem; letter-spacing: 0.25rem; line-height: 1.8rem; margin-right: -1.5rem;}
    .promo--card .promo-sub   { font-size: 0.75rem; letter-spacing: 0.14rem; line-height: 1.5rem;}
    .promo--card .promo-cta   { font-size: 0.9rem; margin-top: 1rem;}
  }

  /* ============ 横長型 ============ */
  .promo--horizontal {
    container-type: inline-size;
    container-name: promo-h;
  }

  /* PC基本：hTitle大きく左 | titleSingleコピー中央 | CTA右端 */
  .promo--horizontal .promo-inner {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 2rem;
    padding: 1.6rem 2rem;
    box-sizing: border-box;
  }

  .promo--horizontal .promo-right { display: contents; }

  .promo--horizontal .promo-title--multi {
    font-family: "Cormorant Garamond", serif;
    font-weight: 300;
    font-size: 1.4rem;
    letter-spacing: 0.35em;
    line-height: 1;
    white-space: nowrap;
    flex-shrink: 0;
    order: 1;
  }

  .promo--horizontal .promo-sub--multi { display: none; }

  .promo--horizontal .promo-title--single {
    display: block;
    flex: 1;
    font-family: "Shippori Mincho", serif;
    font-size: 1rem;
    letter-spacing: 0.15em;
    line-height: 1;
    opacity: 0.8;
    white-space: nowrap;
    order: 2;
  }

  .promo--horizontal .promo-sub--single { display: none; }

  .promo--horizontal .promo-cta {
    font-size: 0.82rem;
    align-self: center;
    flex-shrink: 0;
    margin-top: 0;
    order: 3;
  }

    @container promo-h (min-width: 900px) {
    .promo--horizontal .promo-inner         { margin: 0.5rem 0; gap: 2.5rem; }
    .promo--horizontal .promo-title--multi  { font-size: 2rem; }
    .promo--horizontal .promo-title--single { font-size: 1.2rem; }
    .promo--horizontal .promo-cta           { font-size: 0.88rem; }
  }

  @container promo-h (min-width: 1100px) {
    .promo--horizontal .promo-inner         { margin: 0.5rem 0; gap: 2.5rem; }
    .promo--horizontal .promo-title--multi  { font-size: 2rem; }
    .promo--horizontal .promo-title--single { font-size: 1.2rem; }
    .promo--horizontal .promo-cta           { font-size: 0.88rem; }
  }

  @container promo-h (min-width: 1400px) {
    .promo--horizontal .promo-inner         { padding: 0.85rem 4rem; gap: 2rem; margin: 0.7rem 0;}
    .promo--horizontal .promo-title--multi  { font-size: 2.1rem; }
    .promo--horizontal .promo-title--single { font-size: 1.4rem; margin-bottom: 0.22rem;}
    .promo--horizontal .promo-cta           { font-size: 1rem; }
  }

  /* スマホ（〜650px）：一切変更なし */
  @container promo-h (max-width: 650px) {
    .promo--horizontal .promo-inner {
      display: grid;
      grid-template-areas:
        "title title"
        "sub   cta";
      grid-template-columns: 1fr auto;
      align-items: center;
      padding: 1.25rem 1.35rem 1rem;
      gap: 0.5rem 1rem;
    }

    .promo--horizontal .promo-title--multi {
      grid-area: title;
      font-size: 2rem;
      letter-spacing: 0.3em;
      text-align: center;
    }
    .promo--horizontal .promo-title--single { display: none; }

    .promo--horizontal .promo-sub--multi  { display: none; }
    .promo--horizontal .promo-sub--single {
      display: block;
      grid-area: sub;
      font-family: "Shippori Mincho", serif;
      font-size: 0.68rem;
      letter-spacing: 0.15em;
      opacity: 0.6;
      white-space: nowrap;
      align-self: center;
    }

    .promo--horizontal .promo-cta {
      grid-area: cta;
      font-size: 0.78rem;
      align-self: center;
    }
  }

  @container promo-h (max-width: 380px) {
    .promo--horizontal .promo-title--multi { font-size: 1.3rem; text-align: left;}
    .promo--horizontal .promo-sub--single  { font-size: 0.6rem; }
    .promo--horizontal .promo-cta          { font-size: 0.7rem; }
  }
</style>

<script>
  function initPromoTriggers() {
    document.querySelectorAll<HTMLElement>(".promo--trigger").forEach((el) => {
      el.addEventListener("click", (e) => {
        e.preventDefault();
        (window as any).openPromoOverlay?.();
      });
    });
  }
  document.addEventListener("astro:page-load", initPromoTriggers);
  initPromoTriggers();
</script>